(()=>{"use strict";const t=new class{audioContext;tracks=[];constructor(){this.audioContext=new AudioContext}async initAudio(t){if(console.log("Loading audio files..."),16!==t.length)throw new Error("Expected 16 audio files.");const e=t.map((t=>this.loadAudioFile(t)));(await Promise.all(e)).forEach((t=>{const e=this.audioContext.createBufferSource(),a=this.audioContext.createGain();e.buffer=t,a.gain.value=0,e.connect(a),a.connect(this.audioContext.destination),this.tracks.push({sourceNode:e,gainNode:a}),e.loop=!0,e.start(0)}))}async loadAudioFile(t){const e=await fetch(t),a=await e.arrayBuffer();return this.audioContext.decodeAudioData(a)}unMuteTrack(t){if(console.log("unMuteTrack",t),-1!=t){if(!this.tracks[t])throw new Error(`Track ${t} does not exist.`);this.tracks[t].gainNode.gain.value=1}}muteTrack(t){if(console.log("muteTrack",t),-1!=t){if(!this.tracks[t])throw new Error(`Track ${t} does not exist.`);this.tracks[t].gainNode.gain.value=0}}muteAll(){for(let t=0;t<this.tracks.length;t++)this.muteTrack(t)}};var e=!1;function a(t){const e=t.split("-");return e.length<2?-1:parseInt(e[1])}document.addEventListener("DOMContentLoaded",(()=>{!function(){const a=document.getElementById("start-button"),s=document.getElementById("canvas");if(!s)throw new Error("Canvas not found!");s.style.display="none",a?.addEventListener("click",(()=>{e?(t.muteAll(),e=!1,a.textContent="Start",s.style.display="none"):(async function(){await t.initAudio(["stems/drums.wav","stems/hats.wav","stems/kick-hat.wav","stems/toms.wav","stems/acid-and-chord.wav","stems/bass.wav","stems/drums.wav","stems/hats.wav","stems/kick-hat.wav","stems/toms.wav","stems/acid-and-chord.wav","stems/bass.wav","stems/drums.wav","stems/hats.wav","stems/kick-hat.wav","stems/toms.wav"])}(),e=!0,a.textContent="Stop",s.style.display="block")}))}();const s=document.querySelectorAll(".ball"),n=document.querySelectorAll(".square");let o=null,i=null;const r=e=>{o&&e.classList.contains("square")&&(console.log("Dropped:",o.id,e.id),t.unMuteTrack(a(e.id)),e.appendChild(o),i=null,o.style.display="block",o=null)};s.forEach((e=>{e.addEventListener("dragstart",(s=>{o=e,i=e.parentElement,s.dataTransfer?.setData("text/plain",e.id),console.log("Lifted:",e.id,"from",i.id),t.muteTrack(a(i.id))})),e.addEventListener("touchstart",(s=>{o=e,i=e.parentElement,console.log("Lifted:",e.id,"from",i.id),s.preventDefault(),t.muteTrack(a(i.id))})),e.addEventListener("touchmove",(t=>{if(t.preventDefault(),1===t.touches.length){const a=t.touches[0];e.style.left=a.clientX-25+"px",e.style.top=a.clientY-25+"px"}})),e.addEventListener("touchend",(t=>{if(!o)return;o.style.display="none";const e=t.changedTouches[0],a=document.elementFromPoint(e.clientX,e.clientY);o.style.display="block",r(a)}))})),n.forEach((t=>{t.id||(t.id=`square-${Array.from(n).indexOf(t)}`),t.addEventListener("dragover",(t=>{t.preventDefault()})),t.addEventListener("drop",(e=>{e.preventDefault();const a=e.dataTransfer?.getData("text");a&&(document.getElementById(a),r(t))}))}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFDVkEsRUFBT3ZDLEtBQ1Z1QyxFQUFPdkMsR0FBSyxVQUFVd0MsTUFBTUMsS0FBS3pCLEdBQVMwQixRQUFRSCxNQUVwREEsRUFBT2xDLGlCQUFpQixZQUFhb0IsSUFDbkNBLEVBQUVJLGdCQUFnQixJQUdwQlUsRUFBT2xDLGlCQUFpQixRQUFTb0IsSUFDL0JBLEVBQUVJLGlCQUNGLE1BQU1jLEVBQU9sQixFQUFFRSxjQUFjaUIsUUFBUSxRQUNqQ0QsSUFDV3ZDLFNBQVNHLGVBQWVvQyxHQUNyQ3hCLEVBQVNvQixHLEdBRVgsR0FDRixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3F1YXJlcy8uL3NyYy9tYWluLnRzIiwid2VicGFjazovL3NxdWFyZXMvLi9zcmMvYXVkaW8udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXVkaW9Db250cm9sbGVyIH0gZnJvbSBcIi4vYXVkaW9cIjtcblxuY29uc3QgYWMgPSBuZXcgQXVkaW9Db250cm9sbGVyKCk7XG52YXIgaXNQbGF5aW5nID0gZmFsc2U7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHtcbiAgc2V0VXBCdXR0b25zKCk7XG4gIGNvbnN0IGJhbGxzOiBOb2RlTGlzdE9mPEhUTUxFbGVtZW50PiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYmFsbFwiKTtcbiAgY29uc3Qgc3F1YXJlczogTm9kZUxpc3RPZjxIVE1MRWxlbWVudD4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnNxdWFyZVwiKTtcbiAgbGV0IGFjdGl2ZUJhbGw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gIGxldCBvcmlnaW5TcXVhcmU6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cbiAgY29uc3QgZHJvcEJhbGwgPSAodGFyZ2V0OiBIVE1MRWxlbWVudCkgPT4ge1xuICAgIGlmIChhY3RpdmVCYWxsICYmIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJzcXVhcmVcIikpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiRHJvcHBlZDpcIiwgYWN0aXZlQmFsbC5pZCwgdGFyZ2V0LmlkKTtcbiAgICAgIGFjLnVuTXV0ZVRyYWNrKGlkVG9JbnQodGFyZ2V0LmlkKSk7XG4gICAgICB0YXJnZXQuYXBwZW5kQ2hpbGQoYWN0aXZlQmFsbCk7XG4gICAgICBvcmlnaW5TcXVhcmUgPSBudWxsO1xuICAgICAgYWN0aXZlQmFsbC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiOyAvLyBNYWtlIHN1cmUgdG8gZGlzcGxheSB0aGUgYmFsbCBhZ2FpblxuICAgICAgYWN0aXZlQmFsbCA9IG51bGw7XG4gICAgfVxuICB9O1xuXG4gIGJhbGxzLmZvckVhY2goKGJhbGwpID0+IHtcbiAgICBiYWxsLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgKGU6IERyYWdFdmVudCkgPT4ge1xuICAgICAgYWN0aXZlQmFsbCA9IGJhbGw7XG4gICAgICBvcmlnaW5TcXVhcmUgPSBiYWxsLnBhcmVudEVsZW1lbnQgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICBlLmRhdGFUcmFuc2Zlcj8uc2V0RGF0YShcInRleHQvcGxhaW5cIiwgYmFsbC5pZCk7XG4gICAgICBjb25zb2xlLmxvZyhcIkxpZnRlZDpcIiwgYmFsbC5pZCwgXCJmcm9tXCIsIG9yaWdpblNxdWFyZS5pZCk7XG4gICAgICBhYy5tdXRlVHJhY2soaWRUb0ludChvcmlnaW5TcXVhcmUuaWQpKTtcbiAgICB9KTtcblxuICAgIGJhbGwuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgKGU6IFRvdWNoRXZlbnQpID0+IHtcbiAgICAgIGFjdGl2ZUJhbGwgPSBiYWxsO1xuICAgICAgb3JpZ2luU3F1YXJlID0gYmFsbC5wYXJlbnRFbGVtZW50IGFzIEhUTUxFbGVtZW50O1xuICAgICAgY29uc29sZS5sb2coXCJMaWZ0ZWQ6XCIsIGJhbGwuaWQsIFwiZnJvbVwiLCBvcmlnaW5TcXVhcmUuaWQpO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgYWMubXV0ZVRyYWNrKGlkVG9JbnQob3JpZ2luU3F1YXJlLmlkKSk7XG4gICAgfSk7XG5cbiAgICBiYWxsLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgKGU6IFRvdWNoRXZlbnQpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGlmIChlLnRvdWNoZXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGNvbnN0IHRvdWNoID0gZS50b3VjaGVzWzBdO1xuICAgICAgICBiYWxsLnN0eWxlLmxlZnQgPSBgJHt0b3VjaC5jbGllbnRYIC0gMjV9cHhgOyAvLyBBZGp1c3QgZm9yIGNlbnRlciBvZiB0aGUgYmFsbFxuICAgICAgICBiYWxsLnN0eWxlLnRvcCA9IGAke3RvdWNoLmNsaWVudFkgLSAyNX1weGA7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBiYWxsLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCAoZTogVG91Y2hFdmVudCkgPT4ge1xuICAgICAgaWYgKCFhY3RpdmVCYWxsKSByZXR1cm47XG4gICAgICBhY3RpdmVCYWxsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjsgLy8gVGVtcG9yYXJpbHkgaGlkZSB0aGUgYmFsbCB0byBnZXQgZWxlbWVudCB1bmRlcm5lYXRoXG4gICAgICBjb25zdCB0b3VjaCA9IGUuY2hhbmdlZFRvdWNoZXNbMF07XG4gICAgICBjb25zdCB0YXJnZXRFbGVtZW50ID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChcbiAgICAgICAgdG91Y2guY2xpZW50WCxcbiAgICAgICAgdG91Y2guY2xpZW50WVxuICAgICAgKSBhcyBIVE1MRWxlbWVudDtcbiAgICAgIGFjdGl2ZUJhbGwuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjsgLy8gUmUtZGlzcGxheSB0aGUgYmFsbFxuICAgICAgZHJvcEJhbGwodGFyZ2V0RWxlbWVudCk7XG4gICAgICAvLyAgIGNvbnNvbGUubG9nKFwiRHJvcHBlZDpcIiwgYmFsbC5pZCwgdGFyZ2V0RWxlbWVudC5pZCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHNxdWFyZXMuZm9yRWFjaCgoc3F1YXJlKSA9PiB7XG4gICAgaWYgKCFzcXVhcmUuaWQpIHtcbiAgICAgIHNxdWFyZS5pZCA9IGBzcXVhcmUtJHtBcnJheS5mcm9tKHNxdWFyZXMpLmluZGV4T2Yoc3F1YXJlKX1gO1xuICAgIH1cbiAgICBzcXVhcmUuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdvdmVyXCIsIChlOiBEcmFnRXZlbnQpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIHNxdWFyZS5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCAoZTogRHJhZ0V2ZW50KSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCBkYXRhID0gZS5kYXRhVHJhbnNmZXI/LmdldERhdGEoXCJ0ZXh0XCIpO1xuICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgY29uc3QgYmFsbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRhdGEpIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICBkcm9wQmFsbChzcXVhcmUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5mdW5jdGlvbiBpZFRvSW50KGlkOiBzdHJpbmcpOiBudW1iZXIge1xuICBjb25zdCBwYXJ0cyA9IGlkLnNwbGl0KFwiLVwiKTtcbiAgaWYgKHBhcnRzLmxlbmd0aCA8IDIpIHtcbiAgICByZXR1cm4gLTE7XG4gIH1cbiAgcmV0dXJuIHBhcnNlSW50KHBhcnRzWzFdKTtcbn1cblxuZnVuY3Rpb24gc2V0VXBCdXR0b25zKCkge1xuICBjb25zdCBzdGFydEJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3RhcnQtYnV0dG9uXCIpO1xuICBjb25zdCBjID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW52YXNcIik7XG4gIGlmICghYykge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkNhbnZhcyBub3QgZm91bmQhXCIpO1xuICB9XG4gIGMuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICBzdGFydEJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBpZiAoIWlzUGxheWluZykge1xuICAgICAgaW5pdEF1ZGlvKCk7XG4gICAgICBpc1BsYXlpbmcgPSB0cnVlO1xuICAgICAgc3RhcnRCdXR0b24udGV4dENvbnRlbnQgPSBcIlN0b3BcIjtcbiAgICAgIGMuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgYWMubXV0ZUFsbCgpO1xuICAgICAgaXNQbGF5aW5nID0gZmFsc2U7XG4gICAgICBzdGFydEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU3RhcnRcIjtcbiAgICAgIGMuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgIH1cbiAgfSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGluaXRBdWRpbygpIHtcbiAgYXdhaXQgYWMuaW5pdEF1ZGlvKFtcbiAgICBcInN0ZW1zL2RydW1zLndhdlwiLFxuICAgIFwic3RlbXMvaGF0cy53YXZcIixcbiAgICBcInN0ZW1zL2tpY2staGF0LndhdlwiLFxuICAgIFwic3RlbXMvdG9tcy53YXZcIixcbiAgICBcInN0ZW1zL2FjaWQtYW5kLWNob3JkLndhdlwiLFxuICAgIFwic3RlbXMvYmFzcy53YXZcIixcbiAgICBcInN0ZW1zL2RydW1zLndhdlwiLFxuICAgIFwic3RlbXMvaGF0cy53YXZcIixcbiAgICBcInN0ZW1zL2tpY2staGF0LndhdlwiLFxuICAgIFwic3RlbXMvdG9tcy53YXZcIixcbiAgICBcInN0ZW1zL2FjaWQtYW5kLWNob3JkLndhdlwiLFxuICAgIFwic3RlbXMvYmFzcy53YXZcIixcbiAgICBcInN0ZW1zL2RydW1zLndhdlwiLFxuICAgIFwic3RlbXMvaGF0cy53YXZcIixcbiAgICBcInN0ZW1zL2tpY2staGF0LndhdlwiLFxuICAgIFwic3RlbXMvdG9tcy53YXZcIixcbiAgXSk7XG4gIC8vICAgYWMudW5NdXRlVHJhY2soMCk7XG59XG4iLCJleHBvcnQgY2xhc3MgQXVkaW9Db250cm9sbGVyIHtcbiAgcHJpdmF0ZSBhdWRpb0NvbnRleHQ6IEF1ZGlvQ29udGV4dDtcbiAgcHJpdmF0ZSB0cmFja3M6IHsgc291cmNlTm9kZTogQXVkaW9CdWZmZXJTb3VyY2VOb2RlOyBnYWluTm9kZTogR2Fpbk5vZGUgfVtdID1cbiAgICBbXTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmF1ZGlvQ29udGV4dCA9IG5ldyBBdWRpb0NvbnRleHQoKTtcbiAgfVxuXG4gIGFzeW5jIGluaXRBdWRpbyhmaWxlTmFtZXM6IHN0cmluZ1tdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc29sZS5sb2coXCJMb2FkaW5nIGF1ZGlvIGZpbGVzLi4uXCIpXG4gICAgaWYgKGZpbGVOYW1lcy5sZW5ndGggIT09IDE2KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFeHBlY3RlZCAxNiBhdWRpbyBmaWxlcy5cIik7XG4gICAgfVxuXG4gICAgY29uc3QgZmlsZVByb21pc2VzID0gZmlsZU5hbWVzLm1hcCgoZmlsZU5hbWUpID0+XG4gICAgICB0aGlzLmxvYWRBdWRpb0ZpbGUoZmlsZU5hbWUpXG4gICAgKTtcblxuICAgIGNvbnN0IGF1ZGlvQnVmZmVycyA9IGF3YWl0IFByb21pc2UuYWxsKGZpbGVQcm9taXNlcyk7XG5cbiAgICBhdWRpb0J1ZmZlcnMuZm9yRWFjaCgoYnVmZmVyKSA9PiB7XG4gICAgICBjb25zdCBzb3VyY2VOb2RlID0gdGhpcy5hdWRpb0NvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7XG4gICAgICBjb25zdCBnYWluTm9kZSA9IHRoaXMuYXVkaW9Db250ZXh0LmNyZWF0ZUdhaW4oKTtcblxuICAgICAgc291cmNlTm9kZS5idWZmZXIgPSBidWZmZXI7XG4gICAgICBnYWluTm9kZS5nYWluLnZhbHVlID0gMDsgLy8gU3RhcnQgbXV0ZWRcblxuICAgICAgc291cmNlTm9kZS5jb25uZWN0KGdhaW5Ob2RlKTtcbiAgICAgIGdhaW5Ob2RlLmNvbm5lY3QodGhpcy5hdWRpb0NvbnRleHQuZGVzdGluYXRpb24pO1xuXG4gICAgICB0aGlzLnRyYWNrcy5wdXNoKHsgc291cmNlTm9kZSwgZ2Fpbk5vZGUgfSk7XG4gICAgXG4gICAgICBzb3VyY2VOb2RlLmxvb3AgPSB0cnVlO1xuICAgICAgc291cmNlTm9kZS5zdGFydCgwKTsgLy8gUGxheSBpbW1lZGlhdGVseSBpbiBzeW5jXG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGxvYWRBdWRpb0ZpbGUodXJsOiBzdHJpbmcpOiBQcm9taXNlPEF1ZGlvQnVmZmVyPiB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKTtcbiAgICByZXR1cm4gdGhpcy5hdWRpb0NvbnRleHQuZGVjb2RlQXVkaW9EYXRhKGFycmF5QnVmZmVyKTtcbiAgfVxuXG4gIHVuTXV0ZVRyYWNrKHRyYWNrTnVtYmVyOiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZyhcInVuTXV0ZVRyYWNrXCIsIHRyYWNrTnVtYmVyKVxuICAgIGlmICh0cmFja051bWJlciA9PSAtMSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodGhpcy50cmFja3NbdHJhY2tOdW1iZXJdKSB7XG4gICAgICB0aGlzLnRyYWNrc1t0cmFja051bWJlcl0uZ2Fpbk5vZGUuZ2Fpbi52YWx1ZSA9IDE7IC8vIFNldCBnYWluIHRvIDEgdG8gdW5tdXRlXG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVHJhY2sgJHt0cmFja051bWJlcn0gZG9lcyBub3QgZXhpc3QuYCk7XG4gICAgfVxuICB9XG5cbiAgbXV0ZVRyYWNrKHRyYWNrTnVtYmVyOiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZyhcIm11dGVUcmFja1wiLCB0cmFja051bWJlcik7XG4gICAgaWYgKHRyYWNrTnVtYmVyID09IC0xKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHRoaXMudHJhY2tzW3RyYWNrTnVtYmVyXSkge1xuICAgICAgdGhpcy50cmFja3NbdHJhY2tOdW1iZXJdLmdhaW5Ob2RlLmdhaW4udmFsdWUgPSAwOyAvLyBTZXQgZ2FpbiB0byAwIHRvIG11dGVcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBUcmFjayAke3RyYWNrTnVtYmVyfSBkb2VzIG5vdCBleGlzdC5gKTtcbiAgICB9XG4gIH1cblxuICBtdXRlQWxsKCk6IHZvaWQge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50cmFja3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMubXV0ZVRyYWNrKGkpO1xuICAgIH1cbiAgfVxufVxuIl0sIm5hbWVzIjpbImFjIiwiYXVkaW9Db250ZXh0IiwidHJhY2tzIiwiY29uc3RydWN0b3IiLCJ0aGlzIiwiQXVkaW9Db250ZXh0IiwiaW5pdEF1ZGlvIiwiZmlsZU5hbWVzIiwiY29uc29sZSIsImxvZyIsImxlbmd0aCIsIkVycm9yIiwiZmlsZVByb21pc2VzIiwibWFwIiwiZmlsZU5hbWUiLCJsb2FkQXVkaW9GaWxlIiwiUHJvbWlzZSIsImFsbCIsImZvckVhY2giLCJidWZmZXIiLCJzb3VyY2VOb2RlIiwiY3JlYXRlQnVmZmVyU291cmNlIiwiZ2Fpbk5vZGUiLCJjcmVhdGVHYWluIiwiZ2FpbiIsInZhbHVlIiwiY29ubmVjdCIsImRlc3RpbmF0aW9uIiwicHVzaCIsImxvb3AiLCJzdGFydCIsInVybCIsInJlc3BvbnNlIiwiZmV0Y2giLCJhcnJheUJ1ZmZlciIsImRlY29kZUF1ZGlvRGF0YSIsInVuTXV0ZVRyYWNrIiwidHJhY2tOdW1iZXIiLCJtdXRlVHJhY2siLCJtdXRlQWxsIiwiaSIsImlzUGxheWluZyIsImlkVG9JbnQiLCJpZCIsInBhcnRzIiwic3BsaXQiLCJwYXJzZUludCIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInN0YXJ0QnV0dG9uIiwiZ2V0RWxlbWVudEJ5SWQiLCJjIiwic3R5bGUiLCJkaXNwbGF5IiwidGV4dENvbnRlbnQiLCJhc3luYyIsInNldFVwQnV0dG9ucyIsImJhbGxzIiwicXVlcnlTZWxlY3RvckFsbCIsInNxdWFyZXMiLCJhY3RpdmVCYWxsIiwib3JpZ2luU3F1YXJlIiwiZHJvcEJhbGwiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImFwcGVuZENoaWxkIiwiYmFsbCIsImUiLCJwYXJlbnRFbGVtZW50IiwiZGF0YVRyYW5zZmVyIiwic2V0RGF0YSIsInByZXZlbnREZWZhdWx0IiwidG91Y2hlcyIsInRvdWNoIiwibGVmdCIsImNsaWVudFgiLCJ0b3AiLCJjbGllbnRZIiwiY2hhbmdlZFRvdWNoZXMiLCJ0YXJnZXRFbGVtZW50IiwiZWxlbWVudEZyb21Qb2ludCIsInNxdWFyZSIsIkFycmF5IiwiZnJvbSIsImluZGV4T2YiLCJkYXRhIiwiZ2V0RGF0YSJdLCJzb3VyY2VSb290IjoiIn0=