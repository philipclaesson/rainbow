(()=>{"use strict";const e=new class{audioContext;tracks=[];slowAverage=39;constructor(){this.audioContext=new AudioContext}async initAudio(e){if(16!==e.length)throw new Error("Expected 16 audio files.");const t=e.map((e=>this.loadAudioFile(e)));(await Promise.all(t)).forEach((e=>{const t=this.audioContext.createBufferSource(),n=this.audioContext.createGain();t.buffer=e,n.gain.value=0;const o=this.audioContext.createAnalyser();o.fftSize=2048,n.connect(o),t.connect(n),n.connect(this.audioContext.destination),this.tracks.push({sourceNode:t,gainNode:n,analyserNode:o}),t.loop=!0,t.start(0)}))}async loadAudioFile(e){const t=await fetch(e),n=await t.arrayBuffer();return this.audioContext.decodeAudioData(n)}getNoiseColor(e){const t=this.tracks[e].analyserNode,n=new Uint8Array(t.frequencyBinCount);t.getByteFrequencyData(n);const o=n.reduce(((e,t)=>e+t),0)/n.length;return`hsl(${Math.min(100+5*o,240)}, 100%, 50%)`}getFrequencyColor(e){if(0===this.tracks[e].gainNode.gain.value)return`hsl(${this.slowAverage+e}, 100%, 50%)`;const t=this.tracks[e].analyserNode,n=new Uint8Array(t.frequencyBinCount);t.getByteFrequencyData(n);const o=Math.max(...n),a=n.indexOf(o);return this.updateSlowAverage(a),`hsl(${this.slowAverage+e+10*a%240}, 100%, 50%)`}updateSlowAverage(e){this.slowAverage=this.slowAverage+.001*e%240}unMuteTrack(e){if(-1!=e){if(!this.tracks[e])throw new Error(`Track ${e} does not exist.`);this.tracks[e].gainNode.gain.value=.5}}muteTrack(e){if(-1!=e){if(!this.tracks[e])throw new Error(`Track ${e} does not exist.`);this.tracks[e].gainNode.gain.value=0}}muteAll(){for(let e=0;e<this.tracks.length;e++)this.muteTrack(e)}},t=16;var n=!1,o=!1,a=null;function s(e){document.querySelectorAll(".ball").forEach((t=>{t.style.display=e?"block":"none"}))}function r(e){if(!e)return-1;const t=e.split("square-");return t.length<2?-1:parseInt(t[1])}function i(e){if(e){const e=document.createElement("div");e.classList.add("spinner"),e.id="spinner",document.body.appendChild(e)}else{const e=document.getElementById("spinner");e?.remove()}}function d(){if(requestAnimationFrame(d),n)for(let n=0;n<t;n++){const t=document.getElementById(`square-${n}`);t&&(t.style.backgroundColor=e.getFrequencyColor(n))}}document.addEventListener("DOMContentLoaded",(()=>{!function(){const c=document.getElementById("start-button"),l=document.getElementById("info");c?.addEventListener("click",(async()=>{c.remove(),l?.remove(),i(!0),await async function(){n||(await e.initAudio(["stems/4-on-floor.wav","stems/bass.wav","stems/dnb-124.wav","stems/drums.wav","stems/hats.wav","stems/kick-hat.wav","stems/smooth-chords.wav","stems/toms.wav","stems/guitar.wav","stems/bass.wav","stems/dnb-124.wav","stems/drums.wav","stems/hats.wav","stems/kick-hat.wav","stems/smooth-chords.wav","stems/extacy.wav"]),n=!0)}(),i(!1),function(){const e=document.createElement("div");e.classList.add("matrix"),e.id="matrix",document.body.appendChild(e);for(let n=0;n<t;n++){const t=document.createElement("div");t.classList.add("square"),t.id=`square-${n}`,e.appendChild(t)}(a=document.createElement("div")).classList.add("ballhome"),a.id="ballhome",document.body.appendChild(a);for(let e=0;e<3;e++){const t=document.createElement("div");t.classList.add("ball"),t.id=`ball-${e}`,t.draggable=!0,t.innerText="ðŸŒˆ",a.appendChild(t)}}(),function(){const t=document.querySelectorAll(".ball"),n=document.querySelectorAll(".square");let i=null,d=null;const c=t=>{i&&(console.log("Dropped:",i.id,t.id),e.unMuteTrack(r(t.id)),t.appendChild(i),d=null,i.style.display="block",i=null)};if(t.forEach((t=>{t.addEventListener("dragstart",(n=>{i=t,d=t.parentElement,n.dataTransfer?.setData("text/plain",t.id),console.log("[Dragstart]: Lifted",t.id,"from",d.id),e.muteTrack(r(d.id))})),t.addEventListener("touchstart",(n=>{o=!0,i=t,d=t.parentElement,console.log("[Touchstart] Lifted",t.id,"from",d.id),e.muteTrack(r(d.id))})),t.addEventListener("touchmove",(e=>{if(console.log("[Touchmove] Dragging",t.id,e.touches.length),e.preventDefault(),o=!0,1===e.touches.length){const n=e.touches[0];t.style.left=n.clientX-25+"px",t.style.top=n.clientY-25+"px"}})),t.addEventListener("touchend",(e=>{if(console.log("[Touchend] Dropped",t.id),!i)return;s(!1);const n=e.changedTouches[0],o=document.elementFromPoint(n.clientX,n.clientY);s(!0),c(o)}))})),n.forEach((e=>{e.addEventListener("dragover",(e=>{e.preventDefault()})),e.addEventListener("drop",(t=>{t.preventDefault(),c(e)}))})),!a)throw new Error("Ball home not found");a.addEventListener("dragover",(e=>{e.preventDefault()})),a.addEventListener("drop",(e=>{if(e.preventDefault(),!a)throw new Error("Ball home not found");c(a)})),document.addEventListener("dragover",(e=>{o||e.preventDefault()})),document.addEventListener("drop",(e=>{if(!o){const e=document.getElementById("ballhome");c(e)}}))}(),d()}))}()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU0sSUFBSXJELE1BQU0sdUJBRWxCcUQsRUFBU3lCLGlCQUFpQixZQUFhZ0IsSUFDckNBLEVBQUVLLGdCQUFnQixJQUdwQjlDLEVBQVN5QixpQkFBaUIsUUFBU2dCLElBRWpDLEdBREFBLEVBQUVLLGtCQUNHOUMsRUFDSCxNQUFNLElBQUlyRCxNQUFNLHVCQUVsQjBGLEVBQVNyQyxFQUFTLElBR3BCRyxTQUFTc0IsaUJBQWlCLFlBQWFnQixJQUNoQzFDLEdBQ0gwQyxFQUFFSyxnQixJQUdOM0MsU0FBU3NCLGlCQUFpQixRQUFTZ0IsSUFDakMsSUFBSzFDLEVBQWEsQ0FDaEIsTUFBTUMsRUFBV0csU0FBU2dCLGVBQWUsWUFDekNrQixFQUFTckMsRSxJQUdmLENBb0VJdUQsR0FDQWxDLEdBQU0sR0FFVixDQUdFbUMsRUFBbUIsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3NxdWFyZXMvLi9zcmMvbWFpbi50cyIsIndlYnBhY2s6Ly9zcXVhcmVzLy4vc3JjL2F1ZGlvLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEF1ZGlvQ29udHJvbGxlciB9IGZyb20gXCIuL2F1ZGlvXCI7XG5cbmNvbnN0IGFjID0gbmV3IEF1ZGlvQ29udHJvbGxlcigpO1xuY29uc3QgblNxdWFyZXMgPSAxNjtcbmNvbnN0IG5CYWxscyA9IDM7XG52YXIgaXNQbGF5aW5nID0gZmFsc2U7XG52YXIgaXNJbml0aWF0ZWQgPSBmYWxzZTtcbnZhciBtb2JpbGVVc2FnZSA9IGZhbHNlO1xudmFyIGJhbGxIb21lOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXG5mdW5jdGlvbiBjcmVhdGVVSSgpIHtcbiAgY29uc3QgbWF0cml4ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgbWF0cml4LmNsYXNzTGlzdC5hZGQoXCJtYXRyaXhcIik7XG4gIG1hdHJpeC5pZCA9IFwibWF0cml4XCI7XG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobWF0cml4KTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBuU3F1YXJlczsgaSsrKSB7XG4gICAgY29uc3Qgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcInNxdWFyZVwiKTtcbiAgICBzcXVhcmUuaWQgPSBgc3F1YXJlLSR7aX1gO1xuICAgIG1hdHJpeC5hcHBlbmRDaGlsZChzcXVhcmUpO1xuICB9XG4gIGJhbGxIb21lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgYmFsbEhvbWUuY2xhc3NMaXN0LmFkZChcImJhbGxob21lXCIpO1xuICBiYWxsSG9tZS5pZCA9IFwiYmFsbGhvbWVcIjtcbiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChiYWxsSG9tZSk7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBuQmFsbHM7IGkrKykge1xuICAgIGNvbnN0IGJhbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGJhbGwuY2xhc3NMaXN0LmFkZChcImJhbGxcIik7XG4gICAgYmFsbC5pZCA9IGBiYWxsLSR7aX1gO1xuICAgIGJhbGwuZHJhZ2dhYmxlID0gdHJ1ZTtcbiAgICBiYWxsLmlubmVyVGV4dCA9IGDwn4yIYDtcbiAgICBiYWxsSG9tZS5hcHBlbmRDaGlsZChiYWxsKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBpbml0VUkoKSB7XG4gIGNvbnN0IGJhbGxzOiBOb2RlTGlzdE9mPEhUTUxFbGVtZW50PiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYmFsbFwiKTtcbiAgY29uc3Qgc3F1YXJlczogTm9kZUxpc3RPZjxIVE1MRWxlbWVudD4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnNxdWFyZVwiKTtcbiAgbGV0IGFjdGl2ZUJhbGw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gIGxldCBvcmlnaW5TcXVhcmU6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cbiAgY29uc3QgZHJvcEJhbGwgPSAodGFyZ2V0OiBIVE1MRWxlbWVudCkgPT4ge1xuICAgIGlmIChhY3RpdmVCYWxsKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkRyb3BwZWQ6XCIsIGFjdGl2ZUJhbGwuaWQsIHRhcmdldC5pZCk7XG4gICAgICBhYy51bk11dGVUcmFjayhnZXRTcXVhcmVJZCh0YXJnZXQuaWQpKTtcbiAgICAgIHRhcmdldC5hcHBlbmRDaGlsZChhY3RpdmVCYWxsKTtcbiAgICAgIG9yaWdpblNxdWFyZSA9IG51bGw7XG4gICAgICBhY3RpdmVCYWxsLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7IC8vIE1ha2Ugc3VyZSB0byBkaXNwbGF5IHRoZSBiYWxsIGFnYWluXG4gICAgICBhY3RpdmVCYWxsID0gbnVsbDtcbiAgICB9XG4gIH07XG5cbiAgYmFsbHMuZm9yRWFjaCgoYmFsbCkgPT4ge1xuICAgIGJhbGwuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdzdGFydFwiLCAoZTogRHJhZ0V2ZW50KSA9PiB7XG4gICAgICBhY3RpdmVCYWxsID0gYmFsbDtcbiAgICAgIG9yaWdpblNxdWFyZSA9IGJhbGwucGFyZW50RWxlbWVudCBhcyBIVE1MRWxlbWVudDtcbiAgICAgIGUuZGF0YVRyYW5zZmVyPy5zZXREYXRhKFwidGV4dC9wbGFpblwiLCBiYWxsLmlkKTtcbiAgICAgIGNvbnNvbGUubG9nKFwiW0RyYWdzdGFydF06IExpZnRlZFwiLCBiYWxsLmlkLCBcImZyb21cIiwgb3JpZ2luU3F1YXJlLmlkKTtcbiAgICAgIGFjLm11dGVUcmFjayhnZXRTcXVhcmVJZChvcmlnaW5TcXVhcmUuaWQpKTtcbiAgICB9KTtcblxuICAgIGJhbGwuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgKGU6IFRvdWNoRXZlbnQpID0+IHtcbiAgICAgIG1vYmlsZVVzYWdlID0gdHJ1ZTtcbiAgICAgIGFjdGl2ZUJhbGwgPSBiYWxsO1xuICAgICAgb3JpZ2luU3F1YXJlID0gYmFsbC5wYXJlbnRFbGVtZW50IGFzIEhUTUxFbGVtZW50O1xuICAgICAgY29uc29sZS5sb2coXCJbVG91Y2hzdGFydF0gTGlmdGVkXCIsIGJhbGwuaWQsIFwiZnJvbVwiLCBvcmlnaW5TcXVhcmUuaWQpO1xuICAgICAgYWMubXV0ZVRyYWNrKGdldFNxdWFyZUlkKG9yaWdpblNxdWFyZS5pZCkpO1xuICAgIH0pO1xuXG4gICAgYmFsbC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2htb3ZlXCIsIChlOiBUb3VjaEV2ZW50KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhcIltUb3VjaG1vdmVdIERyYWdnaW5nXCIsIGJhbGwuaWQsIGUudG91Y2hlcy5sZW5ndGgpO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgbW9iaWxlVXNhZ2UgPSB0cnVlO1xuICAgICAgaWYgKGUudG91Y2hlcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgY29uc3QgdG91Y2ggPSBlLnRvdWNoZXNbMF07XG4gICAgICAgIGJhbGwuc3R5bGUubGVmdCA9IGAke3RvdWNoLmNsaWVudFggLSAyNX1weGA7IC8vIEFkanVzdCBmb3IgY2VudGVyIG9mIHRoZSBiYWxsXG4gICAgICAgIGJhbGwuc3R5bGUudG9wID0gYCR7dG91Y2guY2xpZW50WSAtIDI1fXB4YDtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGJhbGwuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsIChlOiBUb3VjaEV2ZW50KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhcIltUb3VjaGVuZF0gRHJvcHBlZFwiLCBiYWxsLmlkKTtcbiAgICAgIGlmICghYWN0aXZlQmFsbCkgcmV0dXJuO1xuICAgICAgc2hvd0JhbGxzKGZhbHNlKTtcbiAgICAgIGNvbnN0IHRvdWNoID0gZS5jaGFuZ2VkVG91Y2hlc1swXTtcbiAgICAgIGNvbnN0IHRhcmdldEVsZW1lbnQgPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KFxuICAgICAgICB0b3VjaC5jbGllbnRYLFxuICAgICAgICB0b3VjaC5jbGllbnRZXG4gICAgICApIGFzIEhUTUxFbGVtZW50O1xuICAgICAgc2hvd0JhbGxzKHRydWUpO1xuICAgICAgZHJvcEJhbGwodGFyZ2V0RWxlbWVudCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHNxdWFyZXMuZm9yRWFjaCgoc3F1YXJlKSA9PiB7XG4gICAgc3F1YXJlLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCAoZTogRHJhZ0V2ZW50KSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG5cbiAgICBzcXVhcmUuYWRkRXZlbnRMaXN0ZW5lcihcImRyb3BcIiwgKGU6IERyYWdFdmVudCkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZHJvcEJhbGwoc3F1YXJlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaWYgKCFiYWxsSG9tZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkJhbGwgaG9tZSBub3QgZm91bmRcIik7XG4gIH1cbiAgYmFsbEhvbWUuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdvdmVyXCIsIChlOiBEcmFnRXZlbnQpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIH0pO1xuXG4gIGJhbGxIb21lLmFkZEV2ZW50TGlzdGVuZXIoXCJkcm9wXCIsIChlOiBEcmFnRXZlbnQpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYgKCFiYWxsSG9tZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQmFsbCBob21lIG5vdCBmb3VuZFwiKTtcbiAgICB9XG4gICAgZHJvcEJhbGwoYmFsbEhvbWUpO1xuICB9KTtcblxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgKGUpID0+IHtcbiAgICBpZiAoIW1vYmlsZVVzYWdlKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7IC8vIFRoaXMgYWxsb3dzIHRoZSBkcm9wIHRvIGJlIGFjY2VwdGVkLlxuICAgIH1cbiAgfSk7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcm9wXCIsIChlKSA9PiB7XG4gICAgaWYgKCFtb2JpbGVVc2FnZSkge1xuICAgICAgY29uc3QgYmFsbEhvbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJhbGxob21lXCIpIGFzIEhUTUxFbGVtZW50O1xuICAgICAgZHJvcEJhbGwoYmFsbEhvbWUpO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHNob3dCYWxscyhzaG93OiBib29sZWFuKSB7XG4gIGNvbnN0IGJhbGxzOiBOb2RlTGlzdE9mPEhUTUxFbGVtZW50PiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYmFsbFwiKTtcbiAgYmFsbHMuZm9yRWFjaCgoYmFsbCkgPT4ge1xuICAgIGJhbGwuc3R5bGUuZGlzcGxheSA9IHNob3cgPyBcImJsb2NrXCIgOiBcIm5vbmVcIjtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGdldFNxdWFyZUlkKGlkOiBzdHJpbmcgfCBudWxsKTogbnVtYmVyIHtcbiAgaWYgKCFpZCkge1xuICAgIHJldHVybiAtMTtcbiAgfVxuICBjb25zdCBwYXJ0cyA9IGlkLnNwbGl0KFwic3F1YXJlLVwiKTtcbiAgaWYgKHBhcnRzLmxlbmd0aCA8IDIpIHtcbiAgICByZXR1cm4gLTE7XG4gIH1cbiAgcmV0dXJuIHBhcnNlSW50KHBhcnRzWzFdKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gaW5pdEF1ZGlvKCkge1xuICBpZiAoaXNJbml0aWF0ZWQpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgYXdhaXQgYWMuaW5pdEF1ZGlvKFtcbiAgICBcInN0ZW1zLzQtb24tZmxvb3Iud2F2XCIsXG4gICAgXCJzdGVtcy9iYXNzLndhdlwiLFxuICAgIFwic3RlbXMvZG5iLTEyNC53YXZcIixcbiAgICBcInN0ZW1zL2RydW1zLndhdlwiLFxuICAgIFwic3RlbXMvaGF0cy53YXZcIixcbiAgICBcInN0ZW1zL2tpY2staGF0LndhdlwiLFxuICAgIFwic3RlbXMvc21vb3RoLWNob3Jkcy53YXZcIixcbiAgICBcInN0ZW1zL3RvbXMud2F2XCIsXG4gICAgXCJzdGVtcy9ndWl0YXIud2F2XCIsXG4gICAgXCJzdGVtcy9iYXNzLndhdlwiLFxuICAgIFwic3RlbXMvZG5iLTEyNC53YXZcIixcbiAgICBcInN0ZW1zL2RydW1zLndhdlwiLFxuICAgIFwic3RlbXMvaGF0cy53YXZcIixcbiAgICBcInN0ZW1zL2tpY2staGF0LndhdlwiLFxuICAgIFwic3RlbXMvc21vb3RoLWNob3Jkcy53YXZcIixcbiAgICBcInN0ZW1zL2V4dGFjeS53YXZcIixcbiAgXSk7XG4gIGlzSW5pdGlhdGVkID0gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gc3Bpbm5lcihzaG93OiBib29sZWFuKSB7XG4gIGlmIChzaG93KSB7XG4gICAgY29uc3Qgc3Bpbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cbiAgICBzcGlubmVyLmNsYXNzTGlzdC5hZGQoXCJzcGlubmVyXCIpO1xuICAgIHNwaW5uZXIuaWQgPSBcInNwaW5uZXJcIjtcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNwaW5uZXIpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHNwaW5uZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNwaW5uZXJcIik7XG4gICAgc3Bpbm5lcj8ucmVtb3ZlKCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlU3RhcnRCdXR0b24oKSB7XG4gIGNvbnN0IHN0YXJ0QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdGFydC1idXR0b25cIik7XG4gIGNvbnN0IGluZm8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImluZm9cIik7XG4gIHN0YXJ0QnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuICAgIHN0YXJ0QnV0dG9uLnJlbW92ZSgpO1xuICAgIGluZm8/LnJlbW92ZSgpO1xuICAgIHNwaW5uZXIodHJ1ZSk7XG4gICAgYXdhaXQgaW5pdEF1ZGlvKCk7XG4gICAgc3Bpbm5lcihmYWxzZSk7XG4gICAgY3JlYXRlVUkoKTtcbiAgICBpbml0VUkoKTtcbiAgICBkcmF3KCk7XG4gIH0pO1xufVxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XG4gIGNyZWF0ZVN0YXJ0QnV0dG9uKCk7XG59KTtcblxuZnVuY3Rpb24gZHJhdygpIHtcbiAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGRyYXcpO1xuICBpZiAoIWlzSW5pdGlhdGVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgblNxdWFyZXM7IGkrKykge1xuICAgIGNvbnN0IHNxdWFyZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBzcXVhcmUtJHtpfWApIGFzIEhUTUxFbGVtZW50O1xuICAgIGlmIChzcXVhcmUpIHtcbiAgICAgIHNxdWFyZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBhYy5nZXRGcmVxdWVuY3lDb2xvcihpKTtcbiAgICB9XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBBdWRpb0NvbnRyb2xsZXIge1xuICBwcml2YXRlIGF1ZGlvQ29udGV4dDogQXVkaW9Db250ZXh0O1xuICBwcml2YXRlIHRyYWNrczoge1xuICAgIHNvdXJjZU5vZGU6IEF1ZGlvQnVmZmVyU291cmNlTm9kZTtcbiAgICBnYWluTm9kZTogR2Fpbk5vZGU7XG4gICAgYW5hbHlzZXJOb2RlOiBBbmFseXNlck5vZGU7XG4gIH1bXSA9IFtdO1xuICBwcml2YXRlIHNsb3dBdmVyYWdlOiBudW1iZXIgPSAzOTsgLy8gb3JhbmdlXG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5hdWRpb0NvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7XG4gIH1cblxuICBhc3luYyBpbml0QXVkaW8oZmlsZU5hbWVzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmIChmaWxlTmFtZXMubGVuZ3RoICE9PSAxNikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRXhwZWN0ZWQgMTYgYXVkaW8gZmlsZXMuXCIpO1xuICAgIH1cblxuICAgIGNvbnN0IGZpbGVQcm9taXNlcyA9IGZpbGVOYW1lcy5tYXAoKGZpbGVOYW1lKSA9PlxuICAgICAgdGhpcy5sb2FkQXVkaW9GaWxlKGZpbGVOYW1lKVxuICAgICk7XG5cbiAgICBjb25zdCBhdWRpb0J1ZmZlcnMgPSBhd2FpdCBQcm9taXNlLmFsbChmaWxlUHJvbWlzZXMpO1xuXG4gICAgYXVkaW9CdWZmZXJzLmZvckVhY2goKGJ1ZmZlcikgPT4ge1xuICAgICAgY29uc3Qgc291cmNlTm9kZSA9IHRoaXMuYXVkaW9Db250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xuICAgICAgY29uc3QgZ2Fpbk5vZGUgPSB0aGlzLmF1ZGlvQ29udGV4dC5jcmVhdGVHYWluKCk7XG5cbiAgICAgIHNvdXJjZU5vZGUuYnVmZmVyID0gYnVmZmVyO1xuICAgICAgZ2Fpbk5vZGUuZ2Fpbi52YWx1ZSA9IDA7IC8vIFN0YXJ0IG11dGVkXG5cbiAgICAgIC8vIHNldCB1cCBhbiBhbmFseXNlciBzbyB3ZSBjYW4gZG8gY29vbCB2aXN1YWxzXG4gICAgICBjb25zdCBhbmFseXNlck5vZGUgPSB0aGlzLmF1ZGlvQ29udGV4dC5jcmVhdGVBbmFseXNlcigpO1xuICAgICAgYW5hbHlzZXJOb2RlLmZmdFNpemUgPSAyMDQ4O1xuICAgICAgZ2Fpbk5vZGUuY29ubmVjdChhbmFseXNlck5vZGUpO1xuXG4gICAgICBzb3VyY2VOb2RlLmNvbm5lY3QoZ2Fpbk5vZGUpO1xuICAgICAgZ2Fpbk5vZGUuY29ubmVjdCh0aGlzLmF1ZGlvQ29udGV4dC5kZXN0aW5hdGlvbik7XG5cbiAgICAgIHRoaXMudHJhY2tzLnB1c2goeyBzb3VyY2VOb2RlLCBnYWluTm9kZSwgYW5hbHlzZXJOb2RlIH0pO1xuXG4gICAgICBzb3VyY2VOb2RlLmxvb3AgPSB0cnVlO1xuICAgICAgc291cmNlTm9kZS5zdGFydCgwKTsgLy8gUGxheSBpbW1lZGlhdGVseSBpbiBzeW5jXG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGxvYWRBdWRpb0ZpbGUodXJsOiBzdHJpbmcpOiBQcm9taXNlPEF1ZGlvQnVmZmVyPiB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKTtcbiAgICByZXR1cm4gdGhpcy5hdWRpb0NvbnRleHQuZGVjb2RlQXVkaW9EYXRhKGFycmF5QnVmZmVyKTtcbiAgfVxuXG4gIGdldE5vaXNlQ29sb3IodHJhY2s6IG51bWJlcik6IHN0cmluZyB7XG4gICAgY29uc3QgYW5hbHlzZXJOb2RlID0gdGhpcy50cmFja3NbdHJhY2tdLmFuYWx5c2VyTm9kZTtcbiAgICBjb25zdCBkYXRhQXJyYXkgPSBuZXcgVWludDhBcnJheShhbmFseXNlck5vZGUuZnJlcXVlbmN5QmluQ291bnQpO1xuICAgIGFuYWx5c2VyTm9kZS5nZXRCeXRlRnJlcXVlbmN5RGF0YShkYXRhQXJyYXkpO1xuXG4gICAgY29uc3QgYXZlcmFnZSA9XG4gICAgICBkYXRhQXJyYXkucmVkdWNlKChhY2MsIHZhbCkgPT4gYWNjICsgdmFsLCAwKSAvIGRhdGFBcnJheS5sZW5ndGg7XG4gICAgY29uc3QgaHVlID0gTWF0aC5taW4oMTAwICsgYXZlcmFnZSAqIDUsIDI0MCk7XG4gICAgcmV0dXJuIGBoc2woJHtodWV9LCAxMDAlLCA1MCUpYDtcbiAgfVxuXG4gIGdldEZyZXF1ZW5jeUNvbG9yKHRyYWNrOiBudW1iZXIpOiBzdHJpbmcge1xuICAgIGNvbnN0IGdhaW5Ob2RlID0gdGhpcy50cmFja3NbdHJhY2tdLmdhaW5Ob2RlO1xuICAgIGlmIChnYWluTm9kZS5nYWluLnZhbHVlID09PSAwKSB7XG4gICAgICAgIHJldHVybiBgaHNsKCR7dGhpcy5zbG93QXZlcmFnZSArIHRyYWNrfSwgMTAwJSwgNTAlKWA7XG4gICAgfVxuICAgIGNvbnN0IGFuYWx5c2VyTm9kZSA9IHRoaXMudHJhY2tzW3RyYWNrXS5hbmFseXNlck5vZGU7XG4gICAgY29uc3QgZGF0YUFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYW5hbHlzZXJOb2RlLmZyZXF1ZW5jeUJpbkNvdW50KTtcbiAgICBhbmFseXNlck5vZGUuZ2V0Qnl0ZUZyZXF1ZW5jeURhdGEoZGF0YUFycmF5KTtcblxuICAgIC8vIGdldCB0aGUgaGlnaGVzdCBmcmVxdWVuY3lcbiAgICBjb25zdCBtYXggPSBNYXRoLm1heCguLi5kYXRhQXJyYXkpO1xuICAgIGNvbnN0IG1heEluZGV4ID0gZGF0YUFycmF5LmluZGV4T2YobWF4KTtcbiAgICB0aGlzLnVwZGF0ZVNsb3dBdmVyYWdlKG1heEluZGV4KTtcblxuICAgIGNvbnN0IGh1ZSA9IHRoaXMuc2xvd0F2ZXJhZ2UgKyB0cmFjayArICgobWF4SW5kZXggKiAxMCkgJSAyNDApO1xuICAgIHJldHVybiBgaHNsKCR7aHVlfSwgMTAwJSwgNTAlKWA7XG4gIH1cblxuICB1cGRhdGVTbG93QXZlcmFnZSh2YWx1ZTogbnVtYmVyKSB7XG4gICAgdGhpcy5zbG93QXZlcmFnZSA9IHRoaXMuc2xvd0F2ZXJhZ2UgKyB2YWx1ZSAqIDAuMDAxICUgMjQwO1xuICB9XG5cbiAgdW5NdXRlVHJhY2sodHJhY2tOdW1iZXI6IG51bWJlcik6IHZvaWQge1xuICAgIGlmICh0cmFja051bWJlciA9PSAtMSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodGhpcy50cmFja3NbdHJhY2tOdW1iZXJdKSB7XG4gICAgICB0aGlzLnRyYWNrc1t0cmFja051bWJlcl0uZ2Fpbk5vZGUuZ2Fpbi52YWx1ZSA9IDAuNTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBUcmFjayAke3RyYWNrTnVtYmVyfSBkb2VzIG5vdCBleGlzdC5gKTtcbiAgICB9XG4gIH1cblxuICBtdXRlVHJhY2sodHJhY2tOdW1iZXI6IG51bWJlcik6IHZvaWQge1xuICAgIGlmICh0cmFja051bWJlciA9PSAtMSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodGhpcy50cmFja3NbdHJhY2tOdW1iZXJdKSB7XG4gICAgICB0aGlzLnRyYWNrc1t0cmFja051bWJlcl0uZ2Fpbk5vZGUuZ2Fpbi52YWx1ZSA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVHJhY2sgJHt0cmFja051bWJlcn0gZG9lcyBub3QgZXhpc3QuYCk7XG4gICAgfVxuICB9XG5cbiAgbXV0ZUFsbCgpOiB2b2lkIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudHJhY2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLm11dGVUcmFjayhpKTtcbiAgICB9XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJhYyIsImF1ZGlvQ29udGV4dCIsInRyYWNrcyIsInNsb3dBdmVyYWdlIiwiY29uc3RydWN0b3IiLCJ0aGlzIiwiQXVkaW9Db250ZXh0IiwiaW5pdEF1ZGlvIiwiZmlsZU5hbWVzIiwibGVuZ3RoIiwiRXJyb3IiLCJmaWxlUHJvbWlzZXMiLCJtYXAiLCJmaWxlTmFtZSIsImxvYWRBdWRpb0ZpbGUiLCJQcm9taXNlIiwiYWxsIiwiZm9yRWFjaCIsImJ1ZmZlciIsInNvdXJjZU5vZGUiLCJjcmVhdGVCdWZmZXJTb3VyY2UiLCJnYWluTm9kZSIsImNyZWF0ZUdhaW4iLCJnYWluIiwidmFsdWUiLCJhbmFseXNlck5vZGUiLCJjcmVhdGVBbmFseXNlciIsImZmdFNpemUiLCJjb25uZWN0IiwiZGVzdGluYXRpb24iLCJwdXNoIiwibG9vcCIsInN0YXJ0IiwidXJsIiwicmVzcG9uc2UiLCJmZXRjaCIsImFycmF5QnVmZmVyIiwiZGVjb2RlQXVkaW9EYXRhIiwiZ2V0Tm9pc2VDb2xvciIsInRyYWNrIiwiZGF0YUFycmF5IiwiVWludDhBcnJheSIsImZyZXF1ZW5jeUJpbkNvdW50IiwiZ2V0Qnl0ZUZyZXF1ZW5jeURhdGEiLCJhdmVyYWdlIiwicmVkdWNlIiwiYWNjIiwidmFsIiwiTWF0aCIsIm1pbiIsImdldEZyZXF1ZW5jeUNvbG9yIiwibWF4IiwibWF4SW5kZXgiLCJpbmRleE9mIiwidXBkYXRlU2xvd0F2ZXJhZ2UiLCJ1bk11dGVUcmFjayIsInRyYWNrTnVtYmVyIiwibXV0ZVRyYWNrIiwibXV0ZUFsbCIsImkiLCJuU3F1YXJlcyIsImlzSW5pdGlhdGVkIiwibW9iaWxlVXNhZ2UiLCJiYWxsSG9tZSIsInNob3dCYWxscyIsInNob3ciLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJiYWxsIiwic3R5bGUiLCJkaXNwbGF5IiwiZ2V0U3F1YXJlSWQiLCJpZCIsInBhcnRzIiwic3BsaXQiLCJwYXJzZUludCIsInNwaW5uZXIiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiYm9keSIsImFwcGVuZENoaWxkIiwiZ2V0RWxlbWVudEJ5SWQiLCJyZW1vdmUiLCJkcmF3IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwic3F1YXJlIiwiYmFja2dyb3VuZENvbG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN0YXJ0QnV0dG9uIiwiaW5mbyIsImFzeW5jIiwibWF0cml4IiwiZHJhZ2dhYmxlIiwiaW5uZXJUZXh0IiwiY3JlYXRlVUkiLCJiYWxscyIsInNxdWFyZXMiLCJhY3RpdmVCYWxsIiwib3JpZ2luU3F1YXJlIiwiZHJvcEJhbGwiLCJ0YXJnZXQiLCJjb25zb2xlIiwibG9nIiwiZSIsInBhcmVudEVsZW1lbnQiLCJkYXRhVHJhbnNmZXIiLCJzZXREYXRhIiwidG91Y2hlcyIsInByZXZlbnREZWZhdWx0IiwidG91Y2giLCJsZWZ0IiwiY2xpZW50WCIsInRvcCIsImNsaWVudFkiLCJjaGFuZ2VkVG91Y2hlcyIsInRhcmdldEVsZW1lbnQiLCJlbGVtZW50RnJvbVBvaW50IiwiaW5pdFVJIiwiY3JlYXRlU3RhcnRCdXR0b24iXSwic291cmNlUm9vdCI6IiJ9